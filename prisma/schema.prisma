generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")   // Prisma 5 uses URL inside schema
}

model group_master {
  id         Int               @id @default(autoincrement())
  group_name String
  generics   generic_master[]
  created_at DateTime          @default(now())
  updated_at DateTime?
}


model category_master {
  id            Int              @id @default(autoincrement())
  category_name String
  generics      generic_master[]
  created_at    DateTime         @default(now())
  updated_at    DateTime?
}


model generic_master {
  id           Int                @id @default(autoincrement())
  generic_name String
  group_id     Int
  category_id  Int
  description  String?
  group        group_master       @relation(fields: [group_id], references: [id])
  category     category_master    @relation(fields: [category_id], references: [id])
  attributes   attribute_master[]
  products     product_master[]
  created_at   DateTime           @default(now())
  updated_at   DateTime?
  
}

model brand_master {
  id          Int              @id @default(autoincrement())
  brand_name  String
  description String?
  products    product_master[]
  created_at  DateTime         @default(now())
  updated_at  DateTime?
}

model product_master {
  id           Int                        @id @default(autoincrement())
  product_name String
  generic_id   Int
  brand_id     Int
  qty          Int                        @default(0)
  rate         Float                      @default(0.0)
  sku          String?
  extra        Json?
  generic      generic_master             @relation(fields: [generic_id], references: [id])
  brand        brand_master               @relation(fields: [brand_id], references: [id])
  attributes   product_attribute_values[]
  created_at   DateTime                   @default(now())
  updated_at   DateTime?
}

model attribute_master {
  id             Int                        @id @default(autoincrement())
  generic_id     Int
  attribute_name String
  input_type     String                     // text, dropdown, number, date, etc.
  is_required    Boolean                    @default(false)
  data_type      String?
  extra          Json?
  generic        generic_master             @relation(fields: [generic_id], references: [id])
  values         attribute_values_master[]
  product_values product_attribute_values[]
  created_at     DateTime                   @default(now())
  updated_at     DateTime?
}

model attribute_values_master {
  id           Int              @id @default(autoincrement())
  attribute_id Int
  value        Json?
  value_key    String?
  attribute    attribute_master @relation(fields: [attribute_id], references: [id])
  created_at   DateTime         @default(now())
  updated_at   DateTime?
}

model product_attribute_values {
  id           Int              @id @default(autoincrement())
  product_id   Int
  attribute_id Int
  value_id     Int?
  value_text   String?
  value_json   Json?
  product      product_master   @relation(fields: [product_id], references: [id])
  attribute    attribute_master @relation(fields: [attribute_id], references: [id])
  created_at   DateTime         @default(now())
  updated_at   DateTime?
}
